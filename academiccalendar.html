<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sehr Academy — Academic Calendar</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --green:#8BC53F;
  --border:#e6e8ec;
  --bg:#f8f7f4;
}

body{
  margin:0;
  font-family:'Nunito',sans-serif;
  background:var(--bg);
  color:#1f2937;
}

/* HEADER */
header{background:#fff;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:1000;}
.wrap{max-width:1200px;margin:auto;padding:14px 20px;display:flex;justify-content:space-between;align-items:center;}
.brand{cursor:pointer;}
.brand span:first-child{font-family:'Montserrat';font-weight:900;color:var(--green);font-size:22px;}
.brand span:last-child{font-family:'Montserrat';font-weight:900;font-size:22px;}
.controls{display:flex;gap:8px;flex-wrap:wrap;}
.btn,.select{padding:8px 12px;border:1px solid var(--border);border-radius:8px;background:#fff;font-weight:700;cursor:pointer;}

/* FILTERS */
.heading{max-width:1200px;margin:20px auto;padding:0 20px;display:flex;gap:10px;flex-wrap:wrap;}
.filter{position:relative;}
.filter-btn{padding:8px 14px;border:1px solid var(--border);border-radius:8px;background:#fff;font-weight:700;cursor:pointer;min-width:120px;text-align:left;}
.filter-menu{position:absolute;top:110%;left:0;background:#fff;border:1px solid var(--border);border-radius:10px;box-shadow:0 12px 25px rgba(0,0,0,.15);padding:10px;display:none;max-height:250px;overflow:auto;z-index:999;}
.filter-menu div{padding:6px 8px;font-size:14px;cursor:pointer;border-radius:6px;}
.filter-menu div:hover{background:#f2f4f7;}
.filter.open .filter-menu{display:block;}

/* CALENDAR */
.calendar{max-width:1200px;margin:auto;padding:20px;}
.weekdays{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  font-weight:800;
  margin-bottom:10px;
  color:#6b7280;
  position:sticky;
  top:70px;
  background:var(--bg);
  z-index:500;
  padding:8px 0;
}
.grid{display:grid;grid-template-columns:repeat(7,1fr);gap:12px;}
.day{background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px;min-height:160px;}
.day.today{border:2px solid var(--green);box-shadow:0 0 15px rgba(139,197,63,.25);}
.day.holiday{background:#fff5e6;border:2px solid #e6c48f;}
.date{font-weight:800;font-family:'Montserrat';margin-bottom:8px;}

/* EVENTS */
.event{border-radius:10px;padding:10px;margin-top:8px;border:1px solid rgba(0,0,0,.05);transition:all .2s ease;}
.event:hover{transform:translateY(-3px) scale(1.015);box-shadow:0 16px 30px rgba(0,0,0,.22);}
.event.upcoming{box-shadow:0 6px 12px rgba(0,0,0,.08);}
.event.today-event{box-shadow:0 14px 22px rgba(0,0,0,.18);}
.event.faded{opacity:.4;filter:grayscale(50%);box-shadow:none;}

/* CLASS COLORS */
.event.class-10{background:linear-gradient(180deg,#f4efe6,#e7dfd2);}
.event.class-11{background:linear-gradient(180deg,#e8f1f8,#dbe7f2);}
.event.class-12{background:linear-gradient(180deg,#f6e8e8,#edd9d9);}
.event.neet{background:linear-gradient(180deg,#eef3e7,#dde6d3);}
.event.jee{background:linear-gradient(180deg,#eee9f5,#e2dced);}

/* PILLS */
.pill{display:inline-block;font-size:11px;font-weight:700;padding:4px 8px;border-radius:6px;border:1px solid #ddd;background:#fff;margin-right:5px;margin-top:5px;}
.pill.mode-online{background:#4CAF50;color:#fff;border:none;}
.pill.mode-offline{background:#7b5e57;color:#fff;border:none;}
.pill.teacher{background:#f4f1ea;border:1px solid #e2dbcf;color:#5c4d3c;}

.event-title{font-family:'Montserrat';font-weight:800;font-size:14px;margin-bottom:6px;}
.empty{font-size:12px;opacity:.5;margin-top:8px;}
</style>
</head>

<body>

<header>
<div class="wrap">
<div class="brand" onclick="window.location.href='https://sehracademy.com'">
<span>SEHR</span><span>ACADEMY</span>
</div>
<div class="controls">
<button id="prev" class="btn">◀</button>
<select id="monthSelect" class="select"></select>
<button id="next" class="btn">▶</button>
<button id="todayBtn" class="btn">Today</button>
</div>
</div>
</header>

<div class="heading">
<div class="filter">
<button class="filter-btn" id="classBtn">Class ▾</button>
<div class="filter-menu" id="classMenu"></div>
</div>

<div class="filter">
<button class="filter-btn" id="teacherBtn">Teacher ▾</button>
<div class="filter-menu" id="teacherMenu"></div>
</div>

<div class="filter">
<button class="filter-btn" id="modeBtn">Mode ▾</button>
<div class="filter-menu" id="modeMenu">
<div data-value="Online">Online</div>
<div data-value="Offline">Offline</div>
</div>
</div>

<input type="text" id="searchInput" class="select" placeholder="Search topic...">
<button id="clearAll" class="btn">Clear All</button>
</div>

<main class="calendar">
<div class="weekdays">
<div>Mon</div><div>Tue</div><div>Wed</div>
<div>Thu</div><div>Fri</div><div>Sat</div><div>Sun</div>
</div>
<div id="calendar-grid" class="grid"></div>
</main>

<script>
const SHEET_ID  = "1d5b07U_wV7Dn6RKRpVGhN1hCzdD8NJK9tKli_VIaIoo";
const API_KEY   = "AIzaSyBwUJ420X5QdIfPBJ_BM-ZoFiu2gWxPsjo";
const TAB_EVENTS = "Events";

const MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"];

let DATA=[];
let CURRENT_YM="";
let searchValue="";
let selectedClasses=[];
let selectedTeachers=[];
let selectedModes=[];

function updateButtons(){
classBtn.textContent = selectedClasses.length ? selectedClasses[0]+" ▾" : "Class ▾";
teacherBtn.textContent = selectedTeachers.length ? selectedTeachers[0]+" ▾" : "Teacher ▾";
modeBtn.textContent = selectedModes.length ? selectedModes[0]+" ▾" : "Mode ▾";
}

function clearFilters(){
selectedClasses=[];
selectedTeachers=[];
selectedModes=[];
searchValue="";
searchInput.value="";
updateButtons();
renderCalendar(CURRENT_YM);
}

clearAll.onclick=clearFilters;

function formatTimeRange(start,end){
if(!start||!end)return "";
function convert(t){
t=t.toString().replace(":",".");
let hour=parseFloat(t);
if(isNaN(hour))return "";
let h=Math.floor(hour);
let m=Math.round((hour-h)*60);
let suffix=h>=12?"pm":"am";
h=h%12;if(h===0)h=12;
if(m===0)return h;
return h+"."+ (m<10?"0"+m:m);
}
let startFormatted=convert(start);
let endFormatted=convert(end);
let endHour=parseFloat(end);
let suffix=endHour>=12?"pm":"am";
return `${startFormatted} - ${endFormatted} ${suffix}`;
}

async function fetchData(){
const url=`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${TAB_EVENTS}!A1:Z1000?key=${API_KEY}`;
const res=await fetch(url);
const json=await res.json();
if(!json.values){alert("No data found.");return;}

const [header,...rows]=json.values;
const lowerHeader=header.map(h=>h.toLowerCase());
const idx=n=>lowerHeader.indexOf(n);

DATA=rows.map(r=>({
date:r[idx("date")]||"",
subject:r[idx("subject")]||"",
topic:r[idx("topic")]||"",
teacher:r[idx("teacher")]||"",
class:r[idx("class")]||"",
mode:r[idx("mode")]||"",
start:r[idx("start time")]||"",
end:r[idx("end time")]||""
})).filter(e=>e.date);

populateFilters();
generateMonths();
}

function populateFilters(){
const classes=[...new Set(DATA.map(e=>e.class).filter(Boolean))].sort();
const teachers=[...new Set(DATA.map(e=>e.teacher).filter(Boolean))].sort();

classes.forEach(c=>{
classMenu.innerHTML+=`<div data-value="${c}">${c}</div>`;
});
teachers.forEach(t=>{
teacherMenu.innerHTML+=`<div data-value="${t}">${t}</div>`;
});

document.querySelectorAll("#classMenu div").forEach(item=>{
item.addEventListener("click",()=>{
selectedClasses=[item.dataset.value];
updateButtons();
renderCalendar(CURRENT_YM);
});
});

document.querySelectorAll("#teacherMenu div").forEach(item=>{
item.addEventListener("click",()=>{
selectedTeachers=[item.dataset.value];
updateButtons();
renderCalendar(CURRENT_YM);
});
});

document.querySelectorAll("#modeMenu div").forEach(item=>{
item.addEventListener("click",()=>{
selectedModes=[item.dataset.value];
updateButtons();
renderCalendar(CURRENT_YM);
});
});
}

function generateMonths(){
const sel=monthSelect;
sel.innerHTML="";
const startYear=2026;
const startMonth=0;
const lastDate=new Date(DATA[DATA.length-1].date);
const endYear=lastDate.getFullYear();
const endMonth=lastDate.getMonth();

let y=startYear,m=startMonth;
while(y<endYear||(y===endYear&&m<=endMonth)){
sel.innerHTML+=`<option value="${y}-${String(m+1).padStart(2,"0")}">${MONTHS[m]} ${y}</option>`;
m++;if(m>11){m=0;y++;}
}

const today=new Date();
const currentYM=today.getFullYear()+"-"+String(today.getMonth()+1).padStart(2,"0");
const index=[...sel.options].findIndex(o=>o.value===currentYM);
sel.selectedIndex=index>=0?index:0;
renderCalendar(sel.value);
}

function renderCalendar(ym){
CURRENT_YM=ym;
const grid=document.getElementById("calendar-grid");
grid.innerHTML="";

const [year,month]=ym.split("-").map(Number);
const first=new Date(year,month-1,1);
const last=new Date(year,month,0);
const days=last.getDate();
const lead=(first.getDay()+6)%7;

for(let i=0;i<lead;i++){grid.innerHTML+=`<div class="day"></div>`;}

for(let d=1;d<=days;d++){
const cellDate=new Date(year,month-1,d);
const today=new Date();today.setHours(0,0,0,0);
cellDate.setHours(0,0,0,0);

const div=document.createElement("div");
div.className="day";
if(cellDate.getTime()===today.getTime())div.classList.add("today");
div.innerHTML=`<div class="date">${d}</div>`;

const dateStr=`${year}-${String(month).padStart(2,"0")}-${String(d).padStart(2,"0")}`;

const events=DATA.filter(e=>
e.date===dateStr &&
(selectedClasses.length===0||selectedClasses.includes(e.class)) &&
(selectedTeachers.length===0||selectedTeachers.includes(e.teacher)) &&
(selectedModes.length===0||selectedModes.includes(e.mode)) &&
(!searchValue||e.topic.toLowerCase().includes(searchValue))
);

if(events.length===0){div.innerHTML+=`<div class="empty">No sessions scheduled.</div>`;}

events.forEach(e=>{
const ev=document.createElement("div");
ev.className="event";

const className=e.class.toLowerCase();
if(className.includes("10"))ev.classList.add("class-10");
else if(className.includes("11"))ev.classList.add("class-11");
else if(className.includes("12"))ev.classList.add("class-12");
else if(className.includes("neet"))ev.classList.add("neet");
else if(className.includes("jee"))ev.classList.add("jee");

const eventDate=new Date(e.date);
eventDate.setHours(0,0,0,0);
if(eventDate<today)ev.classList.add("faded");
else if(eventDate.getTime()===today.getTime())ev.classList.add("today-event");
else ev.classList.add("upcoming");

if(e.subject==="Holiday")div.classList.add("holiday");

let pills="";
if(e.class)pills+=`<span class="pill">${e.class}</span>`;
if(e.start&&e.end)pills+=`<span class="pill">${formatTimeRange(e.start,e.end)}</span>`;
if(e.mode==="Online")pills+=`<span class="pill mode-online">Online</span>`;
if(e.mode==="Offline")pills+=`<span class="pill mode-offline">Offline</span>`;
if(e.subject)pills+=`<span class="pill">${e.subject}</span>`;
if(e.teacher)pills+=`<span class="pill teacher">${e.teacher}</span>`;

ev.innerHTML=`<div class="event-title">${e.topic}</div><div>${pills}</div>`;
div.appendChild(ev);
});
grid.appendChild(div);
}
}

document.querySelectorAll(".filter-btn").forEach(btn=>{
btn.addEventListener("click",function(){this.parentElement.classList.toggle("open");});
});

document.addEventListener("click",function(e){
document.querySelectorAll(".filter").forEach(f=>{
if(!f.contains(e.target)){f.classList.remove("open");}
});
});

monthSelect.onchange=e=>renderCalendar(e.target.value);
searchInput.oninput=e=>{searchValue=e.target.value.toLowerCase();renderCalendar(CURRENT_YM);};
prev.onclick=()=>{if(monthSelect.selectedIndex>0){monthSelect.selectedIndex--;renderCalendar(monthSelect.value);}};
next.onclick=()=>{if(monthSelect.selectedIndex<monthSelect.options.length-1){monthSelect.selectedIndex++;renderCalendar(monthSelect.value);}};
todayBtn.onclick=()=>{const today=new Date();const ym=today.getFullYear()+"-"+String(today.getMonth()+1).padStart(2,"0");const index=[...monthSelect.options].findIndex(o=>o.value===ym);if(index>=0){monthSelect.selectedIndex=index;renderCalendar(ym);}};

fetchData();
</script>

</body>
</html>
