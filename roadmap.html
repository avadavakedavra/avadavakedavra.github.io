<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sehr Academy â€” Interactive Roadmap</title>
  <meta name="theme-color" content="#8BC53F" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#8BC53F; --ink:#0f172a; --muted:#6b7280;
      --radius:16px; --shadow:0 12px 30px rgba(15,23,42,.08);
    }
    body{
      margin:0; font-family:Nunito, sans-serif; background:#f9fafb; color:var(--ink);
    }
    header#site-header{position:sticky;top:0;z-index:40;background:rgba(255,255,255,.78);backdrop-filter:saturate(175%) blur(10px);border-bottom:1px solid #e6e8ec}
    main{max-width:1180px;margin:40px auto;padding:0 20px}
    h1{font-family:Montserrat;font-weight:900;font-size:32px}
    .roadmap{margin-top:30px;display:grid;gap:24px}
    .milestone{
      background:linear-gradient(180deg,#fff,#f8fbf2); border:1px solid #e5e7eb;
      border-radius:var(--radius); box-shadow:var(--shadow);
      padding:18px 20px; position:relative;
    }
    .milestone h2{margin:0;font-size:20px;font-family:Montserrat;font-weight:800}
    .progress{margin:12px 0;height:12px;background:#e5e7eb;border-radius:999px;overflow:hidden}
    .progress span{display:block;height:100%;background:linear-gradient(90deg,#d7f0af,var(--primary));width:0%;transition:width 1s}
    .events{margin-top:10px}
    .event{font-size:14px;font-weight:700;color:var(--muted);margin:4px 0}
  </style>
</head>
<body>
  <header id="site-header"></header>
  <script src="/assets/nav.js" defer></script>

  <main>
    <h1>Interactive Roadmap</h1>
    <p>Track syllabus completion milestones with linked academic events.</p>
    <div id="roadmap" class="roadmap"></div>
  </main>

  <script>
    async function loadJSON(path){
      const res = await fetch(path, {cache:'no-cache'});
      return res.json();
    }

    function pctComplete(chapters){
      const total = chapters.length;
      const done = chapters.filter(c=>c.status==='done').length;
      return total? Math.round(done/total*100):0;
    }

    (async function(){
      const syllabus = await loadJSON('/data/syllabus.json');
      const calendar = await loadJSON('/data/academic-2025-2026.json');
      const host = document.getElementById('roadmap');

      syllabus.subjects.forEach(sub=>{
        const div = document.createElement('div');
        div.className='milestone';

        // title + progress
        div.innerHTML = `
          <h2>${sub.name}</h2>
          <div class="progress"><span style="width:${pctComplete(sub.chapters)}%"></span></div>
          <div class="events"></div>
        `;

        // link events (matching subject name)
        const evWrap = div.querySelector('.events');
        calendar.events
          .filter(e=>e.subject && e.subject.toLowerCase().includes(sub.name.toLowerCase()))
          .slice(0,3) // show first 3 upcoming
          .forEach(e=>{
            const p=document.createElement('div');
            p.className='event';
            p.textContent = `${e.date}: ${e.topic}`;
            evWrap.appendChild(p);
          });

        host.appendChild(div);
      });
    })();
  </script>
</body>
</html>
