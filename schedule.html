<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sehr Academy — Schedule</title>
<meta name="theme-color" content="#8BC53F" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --primary:#8BC53F; --text:#0f172a; --muted:#64748b; --bg:#edf3e7;
    --border:rgba(15,23,42,.08); --maxw:1180px; --radius:16px;
    --card-bg:#ffffff;
  }
  *{box-sizing:border-box}
  html,body{margin:0}
  body{
    font-family:Nunito,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--text); background:var(--bg); line-height:1.65;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  /* Header */
  header{position:sticky;top:0;z-index:30;background:rgba(255,255,255,.9);
    border-bottom:1px solid rgba(15,23,42,.06);backdrop-filter:saturate(160%) blur(8px)}
  .container{max-width:var(--maxw);margin:0 auto;padding:0 20px}
  .nav{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
  .brand{display:flex;align-items:center;gap:12px;text-decoration:none}
  .brand-title{display:flex;flex-direction:column;line-height:1}
  .brand-title .name{font-family:Montserrat;font-weight:800;font-size:20px;color:#0b0f10;letter-spacing:.2px}
  .brand-title .sub{font-weight:700;font-size:12px;color:var(--muted);letter-spacing:.6px;text-transform:uppercase}

  /* Professional schedule logo (inline vector) */
  .logo{
    width:36px;height:36px;border-radius:10px;border:1px solid rgba(15,23,42,.08);
    background:#fff; display:inline-flex; align-items:center; justify-content:center;
    box-shadow:0 4px 16px rgba(16,24,40,.06);
  }
  .logo svg{display:block}

  /* Top nav (as provided) */
  nav[aria-label="Primary"] a{
    font-family:Montserrat,sans-serif;color:#0b0f10;text-decoration:none;margin-left:16px;
    font-weight:700;font-size:14px;position:relative
  }
  nav[aria-label="Primary"] a:after{content:"";position:absolute;left:0;bottom:-6px;width:0;height:2px;background:var(--primary);transition:width .18s}
  nav[aria-label="Primary"] a:hover{color:var(--primary)}
  nav[aria-label="Primary"] a:hover:after{width:100%}

  main section{padding:72px 0}

  /* Hero card */
  .card{
    background:#ffffff; border:1px solid rgba(15,23,42,.06); border-radius:var(--radius);
    padding:22px; box-shadow:0 10px 30px rgba(16,24,40,.06)
  }
  h1{font-family:Montserrat,sans-serif;font-weight:800;font-size:32px;letter-spacing:.2px;margin:0}

  /* Controls */
  .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px}
  .chip{
    display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;font-weight:800;cursor:pointer;
    border:1px solid rgba(15,23,42,.08); background:#fff
  }
  .chip[aria-pressed="true"]{ outline:3px solid #e7f5d5 }
  .search{ flex:1; min-width:220px }
  .search input{
    width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(15,23,42,.08); background:#fff; font-weight:800;
  }
  .muted{color:var(--muted);font-weight:700}

  /* Timeline */
  .timeline{ position:relative; margin-top:18px }
  .tl-month{
    position:sticky; top:80px; z-index:5; margin:24px 0 12px; display:inline-block;
    padding:6px 12px; border-radius:10px; font-weight:900; background:#f0f7e7; border:1px solid #e0f2c8;
  }
  .tl-list{ position:relative; }
  .tl-line{ position:absolute; left:18px; top:0; bottom:0; width:2px; background:#e6eedb; z-index:0; }
  .tl-item{ position:relative; padding-left:56px; margin:14px 0; z-index:1; }

  /* Event card — frosty plain white, no gradient */
  .event{
    border:1px solid rgba(15,23,42,.08); border-radius:14px; background:#fff;
    box-shadow:0 8px 24px rgba(16,24,40,.06)
  }
  .card-inner{ padding:16px; }

  /* Dot */
  .tl-dot{
    position:absolute; left:10px; top:22px; width:16px; height:16px; border-radius:50%;
    background:#fff; border:3px solid var(--primary); box-shadow:0 0 0 4px rgba(139,197,63,.15);
  }

  /* Date bar in Sehr green */
  .date-bar{
    display:inline-flex; align-items:center; gap:10px; flex-wrap:wrap;
    background:var(--primary); color:#fff; font-family:Montserrat; font-weight:900;
    border-radius:10px; padding:6px 10px; letter-spacing:.3px;
  }
  .date-text{white-space:nowrap}
  .time-badge{
    display:inline-block; font-weight:900; padding:4px 8px; border-radius:8px; background:rgba(255,255,255,.22); border:1px solid rgba(255,255,255,.35);
  }

  .title{ font-family:Montserrat; font-weight:800; margin-top:10px; font-size:18px }
  .meta{ color:var(--muted); font-weight:800; margin-top:4px }
  .note{ margin-top:8px }

  .today .event{ box-shadow:0 12px 28px rgba(139,197,63,.12) }
  .past .event{ opacity:.9 }

  /* Skeleton + states */
  .skeleton{ animation:pulse 1.2s ease-in-out infinite; background:linear-gradient(90deg,#f0f3ee,#f7faf5,#f0f3ee); background-size:200% 100% }
  @keyframes pulse{ 0%{background-position:0 0} 100%{background-position:200% 0} }
  .sk-item{ height:84px; border-radius:14px; margin:12px 0 }
  .empty{ padding:16px; border-radius:14px; background:#fff; border:1px dashed #e2e8f0; text-align:center; font-weight:900; color:#6b7280 }
  .error{ border-color:#fecaca; background:#fff5f5; color:#b91c1c }

  /* WhatsApp button */
  .cta-wrap{ display:flex; justify-content:center; }
  .btn{
    display:inline-flex; align-items:center; gap:10px; padding:12px 18px; border-radius:999px;
    background:#25D366; color:#fff; text-decoration:none; font-weight:900; border:0; box-shadow:0 8px 20px rgba(37,211,102,.25)
  }
  .btn:hover{ filter:brightness(.95) }
  .btn svg{ width:18px; height:18px }
  @media (max-width:760px){ h1{font-size:26px} }
</style>
</head>
<body>

<header role="banner">
  <div class="container nav">
    <a class="brand" href="https://sehracademy.com" aria-label="Sehr Academy">
      <span class="logo" aria-hidden="true">
        <!-- Inline professional calendar vector -->
        <svg viewBox="0 0 48 48" width="24" height="24" aria-hidden="true">
          <rect x="6" y="10" width="36" height="30" rx="6" fill="white" stroke="#8BC53F" stroke-width="2"/>
          <rect x="6" y="16" width="36" height="4" fill="#8BC53F"/>
          <rect x="14" y="6" width="4" height="10" rx="2" fill="#8BC53F"/>
          <rect x="30" y="6" width="4" height="10" rx="2" fill="#8BC53F"/>
          <!-- grid dots -->
          <circle cx="16" cy="26" r="1.8" fill="#8BC53F"/>
          <circle cx="24" cy="26" r="1.8" fill="#8BC53F"/>
          <circle cx="32" cy="26" r="1.8" fill="#8BC53F"/>
          <circle cx="16" cy="33" r="1.8" fill="#8BC53F"/>
          <circle cx="24" cy="33" r="1.8" fill="#8BC53F"/>
          <circle cx="32" cy="33" r="1.8" fill="#8BC53F"/>
        </svg>
      </span>
      <span class="brand-title">
        <span class="name">Sehr Academy</span>
        <span class="sub">Schedule</span>
      </span>
    </a>

    <!-- YOUR NAV (exact order/links) -->
    <nav aria-label="Primary">
      <a href="https://sehracademy.com/downloads">Downloads</a>
      <a href="https://sehracademy.com/studentlogin">Student Login</a>
      <a href="https://sehracademy.com/#programs">Programs</a>
      <a href="https://sehracademy.com/#contact">Contact</a>
    </nav>
  </div>
</header>

<main>
  <section>
    <div class="container">
      <div class="card">
        <h1>Schedule</h1>
        <div class="controls">
          <button id="toggle-upcoming" class="chip" type="button" aria-pressed="true" title="Show upcoming">Upcoming</button>
          <button id="toggle-past" class="chip" type="button" aria-pressed="false" title="Show past">Past</button>

          <div id="class-chips" class="controls"></div>

          <div class="search">
            <input id="search" type="search" placeholder="Search title or notes…" aria-label="Search schedule">
          </div>
        </div>
      </div>

      <!-- Skeleton while loading -->
      <div id="skeleton" style="margin-top:16px">
        <div class="sk-item skeleton"></div>
        <div class="sk-item skeleton"></div>
        <div class="sk-item skeleton"></div>
      </div>

      <div id="timeline" class="timeline" hidden></div>
      <div id="empty" class="empty" hidden>No items match your filters.</div>
      <div id="error" class="empty error" hidden>Couldn’t load the schedule.</div>
    </div>
  </section>
</main>

<section id="contact" style="padding:28px 0 80px;">
  <div class="container cta-wrap">
    <a class="btn" href="https://wa.me/919539409586" target="_blank" rel="noopener" aria-label="Chat on WhatsApp">
      <!-- WhatsApp vector -->
      <svg viewBox="0 0 32 32" aria-hidden="true"><path d="M19.11 17.08c-.31-.16-1.82-.9-2.1-1.01-.28-.1-.48-.16-.68.17-.2.33-.78 1.01-.96 1.22-.18.2-.35.23-.66.08-.31-.16-1.32-.49-2.51-1.56-.93-.83-1.56-1.86-1.74-2.17-.18-.31-.02-.48.14-.64.14-.14.31-.35.47-.53.16-.18.2-.31.31-.52.1-.2.05-.39-.02-.55-.08-.16-.68-1.63-.93-2.23-.24-.58-.49-.5-.68-.51l-.58-.01c-.2 0-.52.08-.79.39-.27.31-1.04 1.02-1.04 2.49 0 1.46 1.07 2.88 1.22 3.08.16.2 2.11 3.22 5.11 4.5.71.31 1.26.5 1.69.64.71.22 1.36.19 1.88.12.58-.09 1.82-.74 2.08-1.45.26-.71.26-1.32.18-1.45-.08-.13-.28-.2-.58-.35zM16 3.2c-7.07 0-12.8 5.73-12.8 12.8 0 2.25.59 4.37 1.62 6.2L3.2 28.8l6.74-1.76c1.76.96 3.77 1.52 5.93 1.52 7.07 0 12.8-5.73 12.8-12.8S23.07 3.2 16 3.2zm0 22.94c-2.06 0-3.97-.62-5.57-1.68l-.4-.26-4 .99 1.06-3.9-.25-.4a10.97 10.97 0 0 1-1.68-5.59c0-6.07 4.93-11 11-11s11 4.93 11 11-4.93 11-11 11z" fill="#fff"/></svg>
      WhatsApp us
    </a>
  </div>
</section>

<script>
(function(){
  const DATA_URL = "/data/schedule.json?cb=" + Date.now(); // cache-buster

  // DOM
  const $timeline = document.getElementById('timeline');
  const $skeleton = document.getElementById('skeleton');
  const $error = document.getElementById('error');
  const $empty = document.getElementById('empty');
  const $classChips = document.getElementById('class-chips');
  const $search = document.getElementById('search');
  const $tglUpcoming = document.getElementById('toggle-upcoming');
  const $tglPast = document.getElementById('toggle-past');

  let rawItems = [];
  let activeClasses = new Set();
  let show = 'upcoming';
  let searchText = '';

  // Controls
  $tglUpcoming.addEventListener('click', ()=>{ show='upcoming'; $tglUpcoming.setAttribute('aria-pressed','true'); $tglPast.setAttribute('aria-pressed','false'); draw(); });
  $tglPast.addEventListener('click', ()=>{ show='past'; $tglPast.setAttribute('aria-pressed','true'); $tglUpcoming.setAttribute('aria-pressed','false'); draw(); });
  $search.addEventListener('input', ()=>{ searchText = $search.value.trim(); draw(); });

  // Init
  (async function init(){
    try{
      const res = await fetch(DATA_URL, {cache:"no-store"});
      if(!res.ok) throw new Error('HTTP '+res.status);
      const items = await res.json();

      // Normalize & validate
      rawItems = (Array.isArray(items)?items:[])
        .map(x=>({
          date: normalizeDate(x.date),
          time: (x.time || "").toString().trim(),
          title: (x.title || "").toString().trim(),
          cls: (x.cls || "").toString().trim(),
          notes: (x.notes || "").toString().trim()
        }))
        .filter(x=> x.date && x.title);

      renderFilters(rawItems);
      $skeleton.hidden = true;
      $timeline.hidden = false;
      draw();
    }catch(e){
      console.error(e);
      $skeleton.hidden = true;
      $error.hidden = false;
    }
  })();

  // Helpers
  function parseLocalISO(d){
    d = (d||'').trim();
    let dt;
    if(/^\d{4}-\d{1,2}-\d{1,2}$/.test(d)){ const [y,m,dd]=d.split('-').map(Number); dt=new Date(y,m-1,dd); }
    else if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(d)){ const [dd,m,y]=d.split('/').map(Number); dt=new Date(y,m-1,dd); }
    else { const t=new Date(d); dt=isNaN(t)?null:new Date(t.getFullYear(),t.getMonth(),t.getDate()); }
    return dt;
  }
  function normalizeDate(d){
    const dt = parseLocalISO(d); if(!dt) return "";
    return [dt.getFullYear(), String(dt.getMonth()+1).padStart(2,'0'), String(dt.getDate()).padStart(2,'0')].join('-');
  }
  function isToday(dt){ const n=new Date(); return dt && dt.getFullYear()===n.getFullYear() && dt.getMonth()===n.getMonth() && dt.getDate()===n.getDate(); }
  function fmtDate(dt){ return dt.toLocaleDateString(undefined,{weekday:'short', year:'numeric', month:'short', day:'numeric'}); }
  function monthKey(dt){ return dt.getFullYear() + '-' + String(dt.getMonth()+1).padStart(2,'0'); }
  function monthLabel(dt){ return dt.toLocaleDateString(undefined,{month:'long', year:'numeric'}); }
  function escapeHTML(s){ return (s||'').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  function renderFilters(items){
    const classes = Array.from(new Set(items.map(x => x.cls).filter(Boolean))).sort();
    $classChips.innerHTML = '';
    if(!classes.length) return;
    const label = document.createElement('div');
    label.className = 'muted'; label.style.fontWeight='800'; label.textContent='Filter:';
    $classChips.appendChild(label);
    classes.forEach(cls=>{
      const chip = document.createElement('button');
      chip.className='chip'; chip.type='button'; chip.setAttribute('aria-pressed','false'); chip.textContent=cls;
      chip.addEventListener('click', ()=>{
        if(activeClasses.has(cls)) activeClasses.delete(cls); else activeClasses.add(cls);
        chip.setAttribute('aria-pressed', activeClasses.has(cls) ? 'true' : 'false');
        draw();
      });
      $classChips.appendChild(chip);
    });
  }

  function applyFilters(items){
    const now = new Date(); const today0 = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    return items.filter(it=>{
      const dt = parseLocalISO(it.date);
      if(!dt) return false;
      if(show==='upcoming' && dt < today0) return false;
      if(show==='past' && dt >= today0) return false;
      if(activeClasses.size && !activeClasses.has(it.cls)) return false;
      if(searchText){
        const q = searchText.toLowerCase();
        if(!(it.title.toLowerCase().includes(q) || (it.notes||'').toLowerCase().includes(q))) return false;
      }
      return true;
    });
  }

  function draw(){
    const items = applyFilters(rawItems).sort((a,b)=> parseLocalISO(a.date) - parseLocalISO(b.date));
    $timeline.innerHTML = '';
    if(!items.length){ $timeline.hidden = true; $empty.hidden = false; return; }
    $timeline.hidden = false; $empty.hidden = true;

    const listWrap = document.createElement('div'); listWrap.className='tl-list';
    const line = document.createElement('div'); line.className='tl-line'; listWrap.appendChild(line);

    let mk = '';
    items.forEach(it=>{
      const dt = parseLocalISO(it.date);
      const thisMk = monthKey(dt);
      if(thisMk !== mk){
        mk = thisMk;
        const m = document.createElement('div'); m.className='tl-month'; m.textContent = monthLabel(dt);
        $timeline.appendChild(m); $timeline.appendChild(listWrap);
      }

      const li = document.createElement('div');
      li.className = 'tl-item ' + (isToday(dt) ? 'today' : (dt < new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate()) ? 'past' : ''));

      const dateStr = fmtDate(dt);
      const timeStr = it.time ? escapeHTML(it.time) : '';

      li.innerHTML = `
        <div class="tl-dot" aria-hidden="true"></div>
        <div class="event">
          <div class="card-inner">
            <div class="date-bar">
              <span class="date-text">${dateStr}</span>
              ${timeStr ? `<span class="time-badge">${timeStr}</span>` : ``}
            </div>
            <div class="title">${escapeHTML(it.title)}</div>
            <div class="meta">${escapeHTML(it.cls || '')}</div>
            ${it.notes ? `<div class="note">${escapeHTML(it.notes)}</div>` : ``}
          </div>
        </div>`;
      listWrap.appendChild(li);
    });
  }
})();
</script>
</body>
</html>
