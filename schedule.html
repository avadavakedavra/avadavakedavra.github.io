<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SEHR Academy â€“ Event Hub</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --lime:#8BC53F;
  --lime-dark:#6fb22c;
  --glass:rgba(255,255,255,0.65);
  --glass-strong:rgba(255,255,255,0.85);
  --border:rgba(255,255,255,0.35);
  --text:#111827;
  --muted:#6b7280;
}

body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(135deg,#e8f0ff,#f3f8ff,#eef7f2);
  color:var(--text);
}

.main-content{
  padding:120px 40px 60px;
}

.wrapper{
  max-width:1250px;
  margin:auto;
}

.card{
  background:var(--glass);
  backdrop-filter:blur(20px);
  border-radius:28px;
  padding:30px;
  border:1px solid var(--border);
  box-shadow:0 35px 90px rgba(0,0,0,0.12),
             inset 0 1px 0 rgba(255,255,255,0.6);
  margin-bottom:30px;
}

.header{
  font-family:'Montserrat',sans-serif;
  font-size:26px;
  font-weight:800;
}

.dashboard{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  margin-top:25px;
}

.summary-box{
  background:var(--glass-strong);
  border-radius:22px;
  padding:20px;
  font-weight:700;
  text-align:center;
}

.filter-bar{
  margin-top:20px;
}

select{
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(0,0,0,0.05);
  background:white;
  font-weight:600;
}

.event{
  background:var(--glass-strong);
  border-radius:22px;
  padding:22px;
  margin-bottom:20px;
  position:relative;
  border:1px solid var(--border);
  transition:.25s ease;
}

.event.today{
  border:2px solid var(--lime);
}

.event.birthday-today{
  animation:glow 1.6s infinite;
}

@keyframes glow{
  0%{box-shadow:0 0 0 0 rgba(139,197,63,0.4);}
  70%{box-shadow:0 0 0 18px rgba(139,197,63,0);}
  100%{box-shadow:0 0 0 0 rgba(139,197,63,0);}
}

.badge{
  display:inline-block;
  padding:4px 10px;
  border-radius:12px;
  font-size:12px;
  font-weight:700;
  margin-left:8px;
}

.badge.class{background:#e5f3d2;color:#2f5f0a}
.badge.exam{background:#fee2e2;color:#991b1b}
.badge.meeting{background:#dbeafe;color:#1e40af}
.badge.holiday{background:#e5e7eb;color:#374151}
.badge.birthday{background:#f3e8ff;color:#7e22ce}

.event img{
  width:65px;
  height:65px;
  border-radius:50%;
  object-fit:cover;
  position:absolute;
  right:20px;
  top:20px;
}

.section-title{
  font-family:'Montserrat';
  font-weight:700;
  margin:30px 0 15px;
}

.past-toggle{
  cursor:pointer;
  font-weight:600;
  color:var(--lime-dark);
}

.hidden{display:none}

@media(max-width:900px){
  .main-content{padding:110px 20px;}
}
</style>
</head>

<body>

<header id="site-header"></header>
<script src="/assets/nav.js" defer></script>

<div class="main-content">
<div class="wrapper">

<div class="card">
<div class="header">Event Hub â€“ Academic Dashboard</div>

<div class="dashboard">
<div class="summary-box" id="birthdayCount">ğŸ‚ 0 Birthdays Today</div>
<div class="summary-box" id="testWeekCount">ğŸ“ 0 Tests This Week</div>
<div class="summary-box" id="monthCount">ğŸ“… 0 Events This Month</div>
</div>

<div class="filter-bar">
<select id="typeFilter">
<option value="all">All Events</option>
<option value="class">Classes</option>
<option value="exam">Exams</option>
<option value="meeting">Meetings</option>
<option value="holiday">Holidays</option>
<option value="birthday">Birthdays</option>
</select>
</div>
</div>

<div id="todayContainer"></div>
<div id="upcomingContainer"></div>

<div class="section-title past-toggle" onclick="togglePast()">Past Events (Click to Expand)</div>
<div id="pastContainer" class="hidden"></div>

</div>
</div>

<script>
const SHEET_ID="1d5b07U_wV7Dn6RKRpVGhN1hCzdD8NJK9tKli_VIaIoo";
const API_KEY="AIzaSyBwUJ420X5QdIfPBJ_BM-ZoFiu2gWxPsjo";
const RANGE="hub_events!A2:L";

const url=`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;

let allEvents=[];

fetch(url)
.then(res=>res.json())
.then(data=>{
  allEvents=data.values.map(r=>({
    date:new Date(r[0]),
    subject:r[2],
    topic:r[3],
    class:r[6],
    photo:r[10],
    type:r[11]
  }));
  render();
});

function render(){
  const today=new Date();
  const weekEnd=new Date(); weekEnd.setDate(today.getDate()+7);

  let birthdayToday=0,testsWeek=0,monthCount=0;

  todayContainer.innerHTML="";
  upcomingContainer.innerHTML="";
  pastContainer.innerHTML="";

  const filter=typeFilter.value;

  allEvents.sort((a,b)=>a.date-b.date);

  allEvents.forEach(e=>{
    if(filter!="all" && e.type!=filter) return;

    const isToday=sameDay(e.date,today);
    const isFuture=e.date>today;
    const isPast=e.date<today;
    const isBirthdayToday=isToday && e.type==="birthday";

    if(isBirthdayToday) birthdayToday++;
    if(e.type==="exam" && e.date>=today && e.date<=weekEnd) testsWeek++;
    if(e.date.getMonth()===today.getMonth()) monthCount++;

    const div=document.createElement("div");
    div.className="event";
    if(isToday) div.classList.add("today");
    if(isBirthdayToday) div.classList.add("birthday-today");

    div.innerHTML=`
      <strong>${e.date.toDateString()}</strong>
      <span class="badge ${e.type}">${e.type.toUpperCase()}</span>
      <div style="margin-top:8px;font-weight:600">${e.subject||""}</div>
      <div>${e.topic||""}</div>
      <div style="color:var(--muted);font-size:14px">${e.class||""}</div>
      ${isBirthdayToday?'<div style="margin-top:8px;font-weight:700">ğŸ‰ Birthday Today</div>':''}
      ${e.photo?`<img src="${e.photo}">`:''}
    `;

    if(isToday) todayContainer.appendChild(div);
    else if(isFuture) upcomingContainer.appendChild(div);
    else pastContainer.appendChild(div);
  });

  birthdayCount.innerText=`ğŸ‚ ${birthdayToday} Birthdays Today`;
  testWeekCount.innerText=`ğŸ“ ${testsWeek} Tests This Week`;
  monthCount.innerText=`ğŸ“… ${monthCount} Events This Month`;
}

function sameDay(d1,d2){
return d1.getFullYear()===d2.getFullYear() &&
       d1.getMonth()===d2.getMonth() &&
       d1.getDate()===d2.getDate();
}

function togglePast(){
pastContainer.classList.toggle("hidden");
}

typeFilter.addEventListener("change",render);
</script>

</body>
</html>
